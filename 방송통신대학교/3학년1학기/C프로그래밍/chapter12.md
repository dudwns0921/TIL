# 12강. 구조체와 공용체 (2)

## 함수와 구조체

- 함수에서의 구조체 사용
  - 구조체를 함수의 매개변수로 사용
    - 해당 구조체 전체가 복사되기 때문에 편리
    - 구조체 전체가 복사되기 때문에 시간이 많이 걸리고, 기억공간의 낭비가 심함
  - 구조체 포인터를 함수의 매개변수로 사용
    - 구조체를 복사하지 않기 때문에 실행속도가 향상되고, 기억공간의 사용효율도 좋다

## typedef

- 이미 존재하는 자료형에 새로운 이름을 붙이기 위한 키워드
- typedefintion
  - 간단하거나 의미있는 이름으로 바꿀 수 있어 프로그램 이해가 쉽다
  - 구조체 형을 선언하는데 많이 사용

## 구조체 비트필드

- 구조체의 비트필드

  - 주기억장치의 기억공간을 byte 단위가 아닌 bit 단위로 사용
    - 프로그램시 bit 단위의 연산이 필요할 경우
    - int형은 4byte(32 bit) 이므로 1bit를 제외한 31bit의 기억공간이 낭비
    - 데이터별로 낭비되는 크기는 다름

- 구조체 비트필드의 정의

  - ```c
    struct nibble {
    	unsigned short a :4;
    	// 4비트를 사용한다는 의미
    }
    ```

- 비트필드의 자료형은 int나 unsigned로 정의

- 비트필드에 대한 포인터나 배열은 사용 안됨

- 비트필드의 전체 크기는 시스템이 제공하는 int의 크기 이내여야 함

- 비트 필드가 2개의 int 사이에 걸쳐 저장될 수 없음

## 공용체의 개념

- 공용체란?
  - 동일한 기억장소에 여러 유형의 자료를 저장하기 위해서 프로그래머가 선언한 자료형
  - 공용체 안에 포함된 자료들이 같은 기억장소를 공유하여 사용
  - 사용될 자료의 자료형이 유동적일 경우 기억 공간을 효율적으로 사용할 수 있는 장점
- 공용체의 예
  - 공용체의 멤버들이 완전히 다른 자료형을 가질 때 기억공간을 절약하기 위해 사용
  - 급여관리 프로그램에서
    - 원화로 월급을 지급받는 사람 : 정수형으로 처리
    - 달러로 월급을 지급받는 사람 : 실수형으로 처리
    - 공용체를 사용하면 필요에 따라 메모리의 자료형을 선택해서 값을 저장 가능

## 공용체의 사용

- 공용체가 사용되면
  - 공용체의 멤버 중에서 자료크기가 가장 큰 멤버에 대해서만 기억공간이 할당되고, 기억 공간의 시작 위치부터 각 부분을 다른 멤버가 공용으로 사용

## 구조체와 공용체의 차이

1. 목적: 구조는 서로 다른 데이터 유형의 관련 변수를 함께 그룹화하여 단일 엔터티를 형성하는 데 사용됩니다. 여러 정보를 보유할 수 있는 사용자 정의 데이터 유형을 정의할 수 있습니다. 반면 공용체를 사용하면 동일한 메모리 위치에 여러 유형의 데이터를 저장할 수 있지만 한 번에 하나의 공용체 멤버만 활성화할 수 있습니다.
2. 메모리 할당: 구조체에서 각 멤버는 고유한 메모리 공간을 가지며 구조체가 차지하는 총 메모리는 각 멤버가 차지하는 메모리의 합입니다. Union에서 모든 멤버는 동일한 메모리 공간을 공유하며 Union이 차지하는 메모리는 가장 큰 멤버를 담을 수 있을 만큼 큽니다.
3. 메모리 사용: 구조는 모든 구성원에 대한 동시 액세스를 허용합니다. 각 구성원은 해당 값을 독립적으로 유지하며 언제든지 모든 구성원에 액세스할 수 있습니다. 반면 공용체는 한 번에 하나의 값만 보유할 수 있습니다. 한 멤버에 값을 할당하면 다른 멤버의 값이 무효화될 수 있습니다.
4. 크기: 구조의 크기는 정렬 목적으로 추가된 패딩을 포함하여 멤버 크기의 합으로 결정됩니다. 공용체의 크기는 가장 큰 구성원의 크기에 따라 결정됩니다. 가장 큰 구성원의 크기를 수용해야 하기 때문입니다.
5. 사용법: 구조는 사람(이름, 나이, 주소 등) 또는 3D 공간의 한 점(x, y, z 좌표)에 대한 정보를 저장하는 것과 같이 관련 데이터 모음을 표현하려는 경우에 일반적으로 사용됩니다. . 반면 공용체는 제한된 메모리 환경에서 서로 다른 유형의 데이터를 저장하거나 구현하는 것과 같이 동일한 메모리 공간에 서로 다른 유형의 데이터를 저장하고 한 번에 한 유형의 데이터에만 액세스해야 할 때 자주 사용됩니다. 유형 말장난.
